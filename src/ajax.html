<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="referrer" content="no-referrer">

        <title>Ajax</title>
    </head>

    <body>
        Ajax
    </body>

    <script async type="module">
        async function fetchEx(url, option){
            return (await fetch(Object.entries(option?.params ?? {}).reduce((u, [k, v])=>{
                u.searchParams.append(k, v);
                return u;
            }, new URL(url, /^http(s|):\/\//i.test(url) ? undefined : location.href)), {
                headers: Object.entries(option?.headers ?? {}).reduce((h, [k, v])=>{
                    h.append(k, v);
                    return h;
                }, new Headers()),
                method: option?.method ?? "get",
                mode: option?.mode ?? "cors",
                cache: option?.cache ?? "no-cache",
                credentials: option?.credentials ?? "omit",
                referrerPolicy: option?.referrerPolicy ?? "no-referrer",
                referrer: option?.referrer ?? "",
                redirect: option?.redirect ?? "follow",
                keepalive: option?.keepalive ?? false,
                integrity: option?.integrity ?? "",
                signal: option?.signal ?? null,
                window: null,
                body: option?.body ?? null
            }))[option?.type ?? "json"]();
        }

        const result = await fetchEx("http://worldclockapi.com/api/json/utc/now");
        console.log(result);
    </script>
</html>