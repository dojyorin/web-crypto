<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="referrer" content="no-referrer">

        <script src="https://cdn.jsdelivr.net/npm/@zip.js/zip.js@latest/dist/zip.min.js"></script>

        <title>ZIP</title>
    </head>

    <body>
        <input multiple type="file" id="raws">
        <input type="file" accept=".zip" id="archive">
    </body>

    <script async type="module">
        zip.configure({
            useWebWorkers: true,
            maxWorkers: navigator.hardwareConcurrency - 1
        });

        document.getElementById("raws").addEventListener("change", async({target})=>{
            const ctx = new zip.ZipWriter(new zip.Uint8ArrayWriter(), {
                level: 9,
                bufferedWrite: true,
                keepOrder: false
            });

            for(const file of target.files){
                await ctx.add(file.name, new zip.BlobReader(file));
            }

            console.log(await ctx.close());
        });

        document.getElementById("archive").addEventListener("change", async({target})=>{
            const ctx = new zip.ZipReader(new zip.BlobReader(target.files[0]));

            for(const entry of await ctx.getEntries()){
                console.log(entry.filename, await entry.getData(new zip.Uint8ArrayWriter()));
            }

            await ctx.close();
        });
    </script>
</html>